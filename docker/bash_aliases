#!/usr/bin/env bash
# Copyright 2026 Ilja Heitlager
# SPDX-License-Identifier: Apache-2.0



# clean all docker files
__docker_clean() {
	echo "Cleaning up Docker resources..."
	docker images | grep "localhost:" | awk '{print $$3}' | xargs docker rmi -f 2>/dev/null || true
	docker rm -f $(docker ps -aq) 2>/dev/null || true
	docker rmi -f $(docker images -aq) 2>/dev/null || true
	docker volume prune -f 2>/dev/null || true
	docker network prune -f 2>/dev/null || true
	docker system prune -a -f --volumes 2>/dev/null || true
	echo "✓ Docker cleanup completed"
}


alias dclean=__docker_clean

# clean all podman resources
__podman_clean() {
	echo "Cleaning up Podman resources..."
	podman images | grep "localhost:" | awk '{print $3}' | xargs podman rmi -f 2>/dev/null || true
	podman rm -f $(podman ps -aq) 2>/dev/null || true
	podman rmi -f $(podman images -aq) 2>/dev/null || true
	podman volume prune -f 2>/dev/null || true
	podman network prune -f 2>/dev/null || true
	podman system prune -a -f --volumes 2>/dev/null || true
	echo "✓ Podman cleanup completed"
}

alias pm-clean=__podman_clean

# ctop needs TERM fix for tmux-256color
alias ctop='TERM=xterm-256color command ctop'

# ctop for Podman - use Podman socket
alias pm-ctop='TERM=xterm-256color DOCKER_HOST="unix://$(podman machine inspect --format "{{.ConnectionInfo.PodmanSocket.Path}}" 2>/dev/null)" command ctop'

# Podman machine management
alias pm-init='podman machine init --cpus 4 --memory 4096 --disk-size 50'
alias pm-start='podman machine set --rootful podman-machine-default && podman machine start'
alias pm-stop='podman machine stop'
